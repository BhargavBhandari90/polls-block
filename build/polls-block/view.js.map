{"version":3,"file":"polls-block/view.js","mappings":"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","sources":["webpack://polls-block/external module \"@wordpress/interactivity\"","webpack://polls-block/webpack/bootstrap","webpack://polls-block/webpack/runtime/make namespace object","webpack://polls-block/./src/polls-block/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { store, getContext } from '@wordpress/interactivity';\n\nconst { state } = store( 'buntywp-polls', {\n\tstate: {\n\t\tget totalVoteCount() {\n\t\t\tconst context = getContext();\n\t\t\treturn context.totalVotes;\n\t\t},\n\t\tget userLoggedin() {\n\t\t\tconst context = getContext();\n\t\t\treturn context.isLoggedIn;\n\t\t},\n\t},\n\tactions: {\n\t\ttoggleVote: () => {\n\t\t\tconst context = getContext();\n\n\t\t\t// Return, if already voted or not loggedin.\n\t\t\tif ( context.userVoted || ! context.isLoggedIn ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet index = context.item.id;\n\t\t\tcontext.options[ index ].votes =\n\t\t\t\t( context.options[ index ].votes || 0 ) + 1;\n\t\t\tcontext.userSelection = index;\n\t\t\tcontext.options = context.options;\n\t\t\tcontext.totalVotes = Number( context.totalVotes + 1 );\n\t\t\tcontext.userVoted = true;\n\t\t\tsaveVoteToServer( context );\n\t\t},\n\t\tgetPercentage: () => {\n\t\t\tconst context = getContext();\n\t\t\tif ( context.totalVotes === 0 ) {\n\t\t\t\treturn '0%';\n\t\t\t}\n\t\t\tlet index = context.item.id;\n\t\t\tconst percentage =\n\t\t\t\t( context.options[ index ].votes / context.totalVotes ) * 100;\n\t\t\treturn `${ percentage.toFixed( 0 ) }%`;\n\t\t},\n\n\t\tgetUserSelection: () => {\n\t\t\tconst context = getContext();\n\t\t\tlet index = context.item.id;\n\t\t\treturn ! (\n\t\t\t\tparseInt( context.options[ index ].id ) ===\n\t\t\t\tparseInt( context.userSelection )\n\t\t\t);\n\t\t},\n\t},\n\tcallbacks: {\n\t\tlogIsPollOpen: () => {\n\t\t\tconst { isOpen } = getContext();\n\t\t\tconsole.log( '*isOpen*', isOpen );\n\t\t},\n\t},\n} );\n\n/**\n * Save the vote to the server via AJAX.\n *\n * @param {object} context Poll Context.\n */\nfunction saveVoteToServer( context ) {\n\tfetch( state.ajaxUrl, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\n\t\t},\n\t\tbody: new URLSearchParams( {\n\t\t\taction: 'save_poll_vote',\n\t\t\tnonce: state.nonce,\n\t\t\tcontext: JSON.stringify( context ),\n\t\t} ),\n\t} )\n\t\t.then( ( response ) => response.json() )\n\t\t.then( ( data ) => {\n\t\t\tconsole.log( 'Vote saved:', data );\n\t\t} )\n\t\t.catch( ( error ) => {\n\t\t\tconsole.error( 'Error saving vote:', error );\n\t\t} );\n}\n"],"names":["store","getContext","state","totalVoteCount","context","totalVotes","userLoggedin","isLoggedIn","actions","toggleVote","userVoted","index","item","id","options","votes","userSelection","Number","saveVoteToServer","getPercentage","percentage","toFixed","getUserSelection","parseInt","callbacks","logIsPollOpen","isOpen","console","log","fetch","ajaxUrl","method","headers","body","URLSearchParams","action","nonce","JSON","stringify","then","response","json","data","catch","error"],"sourceRoot":""}